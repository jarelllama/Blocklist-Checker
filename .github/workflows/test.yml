name: Test
on:
  workflow_dispatch:

jobs:
  install-dependencies:
    runs-on: ubuntu-latest
    steps:
      - name: Install depedencies
        run: |
          time npm install -g @adguard/dead-domains-linter
          time npm install -g @adguard/hostlist-compiler

      - name: Cache depedencies
        uses: actions/cache@v4
        with:
          path: ~/.npm
          key: ${{ github.run_id }}

  test-cache:
    needs: install-dependencies
    runs-on: ubuntu-latest
    steps:
      - name: Cache depedencies
        uses: actions/cache@v4
        with:
          path: ~/.npm
          key: ${{ github.run_id }}

      - name: Install depedencies
        run: |
          time npm install -g @adguard/dead-domains-linter
          time npm install -g @adguard/hostlist-compiler
          command -v dead-domains-linter
          command -v hostlist-compiler
